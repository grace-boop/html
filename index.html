
<!DOCTYPE html>
<html>
    <head>
		<!--Import Google Icon Font-->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

		<!-- Compiled and minified CSS -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

		<!-- Compiled and minified JavaScript -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>


		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/> -->
		
		<script type="text/javascript">
		function formresponse()
		{
			var m = document.forms["form1"]["dcard"].value;
			<!--var d = document.forms["form1"]["drink"].value;
			if (m==null || m=="")
			{
				alert("留言不可為空白!");
				return false;
			}
			else
			{
				var MySubmit = "https://docs.google.com/forms/d/e/1FAIpQLSdmouXJczmf55Llp9nP3fEa1wAq6rNkf9Ip3gis9EzDp-ZA8Q/formResponse?entry.1533087342=" + m +"&submit=Submit";
				var NewOpen = window.open(MySubmit);
			}
		}
		//
		
		<!--<script>-->
		var xmlhttp = new XMLHttpRequest();
		var url = "https://emma.pixnet.cc/mainpage/blog/categories/hot/19?page=1&per_page=8&api_version=2&format=json";

		xmlhttp.onreadystatechange = function() {
			if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
				var myArr = JSON.parse(xmlhttp.responseText);
				myFunction(myArr);
			}
		}
		xmlhttp.open("GET", url, true);
		xmlhttp.send();		
		</script>
		<!--<script type="text/javascript" src="js/materialize.min.js"></script>-->
		
	  
    </head>

    <body>

      
		<nav>
		<div class="nav-wrapper" style="background-color: #555454;text-align: center">
			<a href="#" class="brand-logo" style="font-size:30px">哈利波特系列電影</a>
			<ul id="nav-mobile" class="right hide-on-med-and-down">
			<!--<li><a href="sass.html">Sass</a></li>
			<li><a href="badges.html">Components</a></li>
			<li><a href="collapsible.html">JavaScript</a></li> -->
		  </ul>
		</div>
		</nav>
		
		<style>
		body{
			background-color:black
		}
		.divcss5{
			margin:0 auto;
			width:70%;
			background-color:#FFFFE8;
		} 
		.combon{
			margin:0 auto;
			width:70%;
			background-color:#FFFFE8;
			text-align: center
		}
		</style>
      
		<div class="row"  id="demo">
		</div>
		<div class="divcss5" style="background-color:#FFFFE8">
			<div class="combon">
				<h3>更多推薦電影</h3>
			</div>
			<div class="row"  id="pixnet-stuff"></div>
		</div>
      
		<!-- 表單的部分 ->
      <!-- 利用Google Visualization讀取Google Sheet https://www.labnol.org/code/google-sheet-d3js-visualization-200608 -->
      <script src="https://www.gstatic.com/charts/loader.js"></script>
      
      <script>
        // https://developers.google.com/chart/interactive/docs/quick_start
        // Load the Visualization API and the corechart package.
        google.charts.load('current', {'packages':['corechart']});

        // Set a callback to run when the Google Visualization API is loaded.	
        google.charts.setOnLoadCallback(init);
       
        function init() {
          // 這個例子使用的試算表是 https://docs.google.com/spreadsheets/d/1QScI5d56Kh-LGywY4WR6EvRGPcalFQYUAdqMxbFVDvk/copy
          // 將上述試算表另存副本後，你要在自己的雲端硬碟將該試算表設定成[知道連結的使用者都能查看]。
          // 然後讓程式讀取 https://docs.google.com/spreadsheets/d/瀏覽器網址列上的網址擷取序號部分/gviz/tq?sheet=工作表名稱
          // 也就是將下列的 1QScI5d56Kh-LGywY4WR6EvRGPcalFQYUAdqMxbFVDvk 更換成自己的檔案序號，以及最後部分指讀取哪個工作表。
          var url =
            'https://docs.google.com/spreadsheets/d/19IQXAENU4BEnj5TrJ9s_4pI5tYq26jHftEuoZwP2D98/gviz/tq?sheet=工作表1';
          var query = new google.visualization.Query(url);
          query.setQuery('select *');
          query.send(processSheetsData);
        }
		//cars = ["https://cdn.europosters.eu/image/1300/posters/harry-potter-and-the-sorcerers-stone-i83426.jpg",
		//		"https://i0.wp.com/image.tmdb.org/t/p/original/csOv5H7R2zdnKaYuTrGVWohmo8d.jpg",
		//		"https://i.pinimg.com/736x/c4/54/01/c454011dd7be6d0129f25932d3bc0c36.jpg",
		//		"https://www.themoviedb.org/t/p/original/fECBtHlr0RB3foNHDiCBXeg9Bv9.jpg",
		//		"https://www.themoviedb.org/t/p/original/g6n8G0xPnBVUIKKK41sNmbZB5h4.jpg",
		//		"https://picfiles.alphacoders.com/348/348611.jpg",
		//		"https://www.themoviedb.org/t/p/original/iGoXIpQb7Pot00EEdwpwPajheZ5.jpg",
		//		"https://i.pinimg.com/originals/0c/d5/ab/0cd5ab1c505e8ba42d4aeea74c706c02.png"]
		//cards = ["Harry Potter and the Philosopher's Stone",
		//		"Harry Potter and the Chamber of Secrets",
		//		"Harry Potter and the Prisoner of Azkaban",
		//		"Harry Potter and the Goblet of Fire",
		//		"Harry Potter and the Order of the Phoenix",
		//		"Harry Potter and the Half-Blood Prince",
		//		"Harry Potter and the Deathly Hallows",
		//		"Harry Potter and the Cursed Child"];

		function processSheetsData(response) {
        var data = response.getDataTable();
        var columns = data.getNumberOfColumns();
        var rows = data.getNumberOfRows();
		
		var text ="";
		for (i = 0;i <rows ; i++){
		 text = text + '<div class="col s12 m3 l2">';
		 text = text + '	<div class="card">';
		 text = text + '		<div class="card-image">';
		 text = text + '			<img src="'+data.getFormattedValue(i,0)+'" width="100%">';
		 //text = text + '     		<img src=' +cars[i] +'>';
		 //text = text + '     		<span class="card-title, font-size:20px" style="font-family:fantasy; height:2em; padding:16px 16px;">'+cards[i]+'</span>';
		 text = text + '     		<span class="card-title, font-size:20px" style="font-family:fantasy; height:2em; padding:16px 16px;">'+data.getFormattedValue(i,1)+'</span>';
		 text = text + '		</div> ';
		 text = text + '		<div class="card-action, font-size:10px" style="height:2em; padding:5px 5px;">';
		 text = text + '			<a class="indigo-text text-darken-3" href="description.html?id='+i+'">'+data.getFormattedValue(i,1)+'</a>';
		 text = text + '			<a href="https://lll1237html.netlify.app/test?id='+i+'" target = "_blank">more</a>';
		 text = text + '		</div> ';
		 text = text + '  	</div> ';
		 text = text + '</div> ';
		 }
          document.getElementById("demo").innerHTML = text;
        }
		
		function myFunction(arr) {
		
			var data = arr.articles;
			var out = "";
			var i;
			for (i = 0; i < data.length; i++) {
				if ( data[i].thumb != "" )
				{
					out = out + '<div class="col s1 m3 l3" style=" height:200px; border:1px #DBDB00 dashed; ">';
					out = out + ' <div class="pixnet" >';
					out = out + '   <div class="pixnet-image">';
					if ( data[i].thumb != "" ) out += '<img src="' + data[i].thumb + '" style="display:block; margin:auto;"/>';
					if ( data[i].title != "" ) out += '<p style="font-size:5px"><a href="' + data[i].link + '" target="_blank">' + data[i].title + '</a></p>';
					if ( data[i].address != undefined ) out += '<p><a href="https://www.google.com.tw/maps?daddr=' + data[i].address + '" target="_blank">' + data[i].address + '</a></p>';
					<!--out += '<p> </p>';
					<!--out += '<br /><br /><br />';
					out = out + '   </div> ';
					out = out + '  </div> ';
					out = out + '</div> ';
				}
			}
			document.getElementById("pixnet-stuff").innerHTML = out;
		}
		</script>
		
		<form name="form1" action="javascript:formresponse();" style="background-color:white;">
			留言: <input type="text" name="dcard"><br />
			<input type="submit" value="Submit">
		</form>
		
		
      
		<!--JavaScript at end of body for optimized loading-->-->
		<script type="text/javascript" src="js/materialize.min.js"></script>
    </body>
</html>








        